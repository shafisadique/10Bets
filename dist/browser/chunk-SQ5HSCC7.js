import{f as l}from"./chunk-HZ5KM2KJ.js";import{A as h,P as u,U as o,fc as p,ic as m,j as s,n as a,q as c}from"./chunk-XV3DYKYB.js";var T=(()=>{let e=class e{constructor(r,t){this.http=r,this.router=t,this.isAuthenticated=new s(this.hasToken()),this.TOKEN_KEY="token",this.apiUrl=m.apiUrl}hasToken(){return!!this.getToken()}login(r){return this.http.post(`${this.apiUrl}/login`,r).pipe(c(t=>{let n=t?.data?.jwt?.accessToken;return n&&(sessionStorage.setItem(this.TOKEN_KEY,n),this.isAuthenticated.next(!0)),t}),h(t=>(console.error("Error during login:",t),a(()=>new Error("Login failed. Please check your credentials.")))))}getToken(){return typeof sessionStorage<"u"?sessionStorage.getItem("token"):null}isLoggedInSync(){return this.isAuthenticated.value}logOut(){sessionStorage.removeItem(this.TOKEN_KEY),this.isAuthenticated.next(!1),this.router.navigate(["/login"])}isTokenExpired(r){let t=JSON.parse(atob(r.split(".")[1])).exp;return Math.floor(new Date().getTime()/1e3)>=t}};e.\u0275fac=function(t){return new(t||e)(o(p),o(l))},e.\u0275prov=u({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();export{T as a};
